
refreshData();
</script>
    <script>
let currentData = null;
let currentTab = 'General';

const translations = {
    en: {
        title: 'Sakuragawa Japan Book Rankings',
        subtitle: 'Top 20 Weekly Rankings',
        source: 'Source : Nippan',
        refresh: 'ğŸ”„ Refresh',
        loading: 'Loading...',
        general: 'General',
        paperback: 'Paperback',
        comics: 'Comics'
    },
    ja: {
        title: 'æ¡œå·æ—¥æœ¬æ›¸ç±ãƒ©ãƒ³ã‚­ãƒ³ã‚°',
        subtitle: 'é€±é–“ãƒˆãƒƒãƒ—20ãƒ©ãƒ³ã‚­ãƒ³ã‚°',
        source: 'ã‚½ãƒ¼ã‚¹ï¼šæ—¥æœ¬æ›¸ç±è²©å£²',
        refresh: 'ğŸ”„ æ›´æ–°',
        loading: 'èª­ã¿è¾¼ã¿ä¸­...',
        general: 'ä¸€èˆ¬',
        paperback: 'æ–‡åº«æœ¬',
        comics: 'ã‚³ãƒŸãƒƒã‚¯ã‚¹'
    },
    fr: {
        title: 'Classements de Livres Sakuragawa Japon',
        subtitle: 'Classements Top 20 Hebdomadaires',
        source: 'Source : Nippan',
        refresh: 'ğŸ”„ Actualiser',
        loading: 'Chargement...',
        general: 'GÃ©nÃ©ral',
        paperback: 'Poche',
        comics: 'Comics'
    }
};

let currentLang = 'en';

const contentDiv = document.getElementById('content');
const refreshBtn = document.getElementById('refreshBtn');
const langBtns = document.querySelectorAll('.lang-btn');
const tabBtns = document.querySelectorAll('.tab-btn');

function t(key) {
    return translations[currentLang]?.[key] || translations.en[key];
}

function loadData() {
    contentDiv.innerHTML = `<p style="text-align: center; color: #999; padding: 40px;">${t('loading')}</p>`;
    
    const jsonUrl = 'https://raw.githubusercontent.com/Gunnerz-Tko/gunners_/main/nippan_books.json?t=' + Date.now();
    console.log('Fetching from:', jsonUrl);
    
    fetch(jsonUrl)
        .then(response => {
            console.log('Response status:', response.status);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Data loaded:', data);
            if (!data.genres) {
                throw new Error('No genres found in data');
            }
            currentData = data;
            renderTab(currentTab);
        })
        .catch(error => {
            console.error('Error loading data:', error);
            contentDiv.innerHTML = `<p style="text-align: center; color: #e74c3c; padding: 40px;">âŒ Error loading data: ${error.message}<br><br>Check the console (F12) for more details.</p>`;
        });
}

function renderBooks(books) {
    if (!books || books.length === 0) {
        return '<p style="text-align: center; color: #999; padding: 40px;">No data available</p>';
    }
    
    let html = '<div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">';
    
    // Table header
    html += '<thead style="background: linear-gradient(135deg, #6366f1 0%, #ec4899 100%); color: white;">';
    html += '<tr>';
    html += '<th style="padding: 15px; text-align: center; font-weight: 700; border-right: 1px solid rgba(255,255,255,0.2); min-width: 70px;">Rank</th>';
    html += '<th style="padding: 15px; text-align: center; font-weight: 700; border-right: 1px solid rgba(255,255,255,0.2); min-width: 100px;">Last Week</th>';
    html += '<th style="padding: 15px; text-align: center; font-weight: 700; border-right: 1px solid rgba(255,255,255,0.2); min-width: 100px;">Cover</th>';
    html += '<th style="padding: 15px; text-align: left; font-weight: 700; border-right: 1px solid rgba(255,255,255,0.2); min-width: 250px;">Title</th>';
    html += '<th style="padding: 15px; text-align: left; font-weight: 700; border-right: 1px solid rgba(255,255,255,0.2); min-width: 200px;">Author</th>';
    html += '<th style="padding: 15px; text-align: left; font-weight: 700; min-width: 200px;">Publisher</th>';
    html += '</tr>';
    html += '</thead>';
    
    // Table body
    html += '<tbody>';
    books.forEach((book, index) => {
        const bgColor = index % 2 === 0 ? 'rgba(99, 102, 241, 0.05)' : 'white';
        html += `<tr style="background: ${bgColor}; border-bottom: 1px solid #e2e8f0;">`;
        
        // Rank
        html += `<td style="padding: 15px; text-align: center; font-weight: 700; color: #6366f1; font-size: 1.1em;">${book.rank || '-'}</td>`;
        
        // Last Week
        html += `<td style="padding: 15px; text-align: center; color: #64748b;">${book.last_week || '-'}</td>`;
        
        // Cover Image
        if (book.image) {
            html += `<td style="padding: 15px; text-align: center;"><img src="${book.image}" alt="${book.title}" style="height: 80px; object-fit: cover; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onerror="this.style.background='#f0f4f8'; this.style.height='80px'; this.style.width='60px';"></td>`;
        } else {
            html += `<td style="padding: 15px; text-align: center; background: #f0f4f8; height: 80px; border-radius: 8px;">-</td>`;
        }
        
        // Title
        html += `<td style="padding: 15px; text-align: left; font-weight: 600; color: #1e293b;">${book.title || '-'}</td>`;
        
        // Author
        html += `<td style="padding: 15px; text-align: left; color: #64748b;">${book.author || '-'}</td>`;
        
        // Publisher
        html += `<td style="padding: 15px; text-align: left; color: #64748b; font-size: 0.9em;">${book.publisher || '-'}</td>`;
        
        html += '</tr>';
    });
    html += '</tbody>';
    html += '</table></div>';
    
    return html;
}

function renderTab(tabName) {
    currentTab = tabName;
    
    // Update active tab button
    tabBtns.forEach(btn => {
        btn.style.borderBottom = btn.getAttribute('data-tab') === tabName ? '3px solid #6366f1' : 'none';
        btn.style.color = btn.getAttribute('data-tab') === tabName ? '#6366f1' : '#64748b';
    });
    
    // Render books
    if (currentData && currentData.genres[tabName]) {
        contentDiv.innerHTML = renderBooks(currentData.genres[tabName]);
    } else {
        contentDiv.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">No data available for this category</p>';
    }
}

function setLanguage(lang) {
    currentLang = lang;
    
    // Update active language button
    langBtns.forEach(btn => {
        btn.style.opacity = btn.getAttribute('data-lang') === lang ? '1' : '0.6';
        btn.style.fontWeight = btn.getAttribute('data-lang') === lang ? 'bold' : 'normal';
    });
    
    // Update page text
    document.querySelector('h1').textContent = t('title');
    document.querySelector('.subtitle').textContent = t('subtitle');
    document.querySelector('.source-text').textContent = t('source');
    refreshBtn.textContent = t('refresh');
    
    // Update tab names
    tabBtns.forEach(btn => {
        const tabName = btn.getAttribute('data-tab');
        btn.textContent = t(tabName.toLowerCase());
    });
}

// Event listeners
refreshBtn.addEventListener('click', loadData);

langBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        setLanguage(btn.getAttribute('data-lang'));
    });
});

tabBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        renderTab(btn.getAttribute('data-tab'));
    });
});

// Load data on page load
loadData();
setLanguage('en');
</script>
</body>
</html>
